{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">

        <h2 class="mb-4 text-center">Publicaciones</h2>

        {% for post in posts %}
            <div class="card shadow-sm mb-4">

                <!-- Imagen -->
                {% if post.image %}
                    <img src="{{ post.image.url }}"
                         class="card-img-top"
                         style="object-fit: cover; max-height: 400px;">
                {% endif %}

                <div class="card-body">
<div class="d-flex align-items-center mb-2">

    <!-- Avatar -->
    <img src="{{ post.user.userprofile.avatar.url }}"
         class="rounded-circle me-2"
         width="45"
         height="45"
         style="object-fit: cover;">

    <div>
        <strong>{{ post.user.username }}</strong><br>
        <small class="text-muted">
            {{ post.created_at|date:"d/m/Y H:i" }}
        </small>
    </div>

</div>


 <!-- Texto -->
        <p>{{ post.content }}</p>
            <hr>
          <!-- Like + contador -->
        <form method="post" action="{% url 'like_toggle' post.pk %}" class="d-inline">
        {% csrf_token %}
         <button type="submit" class="btn btn-sm btn-outline-danger">
          ❤️ Me gusta
         </button>
        </form>
<span class="ms-2 text-muted">
    {{ post.like_set.count }} me gusta{{ post.like_set.count|pluralize }}
</span>

   <!-- Ver publicación -->
         <a href="{% url 'post_detail' post.pk %}" class="btn btn-outline-primary btn-sm float-end">
              Ver publicación →
         </a>
               </div>
            </div>

        {% empty %}
            <p class="text-muted text-center">No hay publicaciones todavía.</p>
        {% endfor %}

    </div>
</div>
{% endblock %}
